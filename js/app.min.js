var app=app||{};function GenerateUUID(){for(var e=p2=p3=p4=p5="",t="0123456789abcdef";8!=e.length;)e+=t[Math.floor(16*Math.random())];for(;4!=p2.length;)p2+=t[Math.floor(16*Math.random())];for(;4!=p3.length;)p3+=t[Math.floor(16*Math.random())];for(;4!=p4.length;)p4+=t[Math.floor(16*Math.random())];for(;12!=p5.length;)p5+=t[Math.floor(16*Math.random())];return e+"-"+p2+"-"+p3+"-"+p4+"-"+p5}function strtolower(e){return e.toString().toLowerCase()}function MatchKeyNeedle(e,t,a,n=!1){if(0==e.length||0==a.length)return -1;var r=Object.keys(e);if(0==r.length)return -2;for(i=0,j=r.length;i<j;i++){var p=e[i];if(void 0!==p[t]){if(strtolower(p[t])!==strtolower(a))continue;if(n)return i;else return p}}return -1}function ArrayValues(e){var t=0,a=[];return e.forEach(function(e,n){a[t++]=e}),a}function GetItem(e=null,t=!1){if(null==e)return app.items;if(0==(e=e.trim()).length||0==app.items.length)return 0;var a=MatchKeyNeedle(app.items,"uuid",e,t);return -1==a?-1:-2==a?-2:a}function AddItem(e={}){if(0!=e.length){e.uuid=GenerateUUID(),e.accepted=!1,app.items.push(e),app.storage.setItem("items",JSON.stringify(app.items));var t=Number(app.storage.getItem("itemsSize"));return app.storage.setItem("itemsSize",++t),SpawnItem(e.title,e.uuid,e.accepted),!0}}function RemoveItem(e){var t=GetItem(e,!0);if(!(t>-1))return!1;delete app.items[t],app.items=ArrayValues(app.items),app.storage.setItem("items",JSON.stringify(app.items));var a=Number(app.storage.getItem("itemsSize"));return app.storage.setItem("itemsSize",--a),!0}function AcceptItem(e){var t=GetItem(e);return!(0>t)&&(t.accepted=!t.accepted,app.storage.setItem("items",JSON.stringify(app.items)),!0)}function SpawnItem(e=null,t=null,a=!1){if(null==e||0==e.trim().length||null==t||0==t.trim().length||0==Object.keys(GetItem(t)).length)return!1;var n=`
<div class="item[[accepted]]" tabindex="1" data-uuid="[[uuid]]"><div class="title-contain"><p>[[title]]</p></div><div class="action-contain"><button class="icon-accept"></button><button class="icon-remove"></button><button class="icon-rename"></button></div></div>
`;return a=a?" accepted":"",n=(n=(n=n.replace("[[uuid]]",t)).replace("[[title]]",e)).replace("[[accepted]]",a),app.element.items.innerHTML+=n,!0}function LoadListItems(){if((len=app.items.length)>0)for(let e=0;e<len;e++){var t=app.items[e];SpawnItem(t.title,t.uuid,t.accepted)}}function TemplateEngineAssignElement(e=null,t=[],a=!1){if(null==e||!(e instanceof HTMLElement)||0==t.length)return!1;var n,r=e;n="number"!=typeof a&&"boolean"!=typeof a?a.toString():[r.innerHTML,r.innerText][+a];for(let p=0,o=t.length;p<o;p++){var l=t[p];void 0!==(literal_data=app.templates[l])&&(n=n.replace("{$"+l+"}",literal_data))}return a?r.innerHTML=n:r.innerText=n,!0}function TemplateEngineAssign(e=!1){e=!!e;var t=document.querySelectorAll('*[template="1"]');for(let a=0,n=t.length;a<n;a++){var r=t[a];if(0!=r.innerHTML.length){var p=r.getAttribute("template-reload")??!1,o=r.getAttribute("template-string")??!1;!1!=p&&!1==o&&r.setAttribute("template-string",r.innerHTML);var l=r.getAttribute("template-html")??!1;e&&(l=!0);var m=TemplateEngineExtractLiterals(r.innerHTML);0!=m.length&&TemplateEngineAssignElement(r,m,l)}}return null}function TemplateEngineExtractLiterals(e){if(0==e.length)return[];var t=[],a=0,n=0;for(let r=0,p=e.length;r<p;r++){var o=e[r],l=e[r+1];if(n){if("}"!=o){t[a]+=o;continue}--n,++a;continue}if("{"==o&&"$"==l){++n,++r,t[a]="";continue}}return t}function TemplateEngineAssignReload(){var e=document.querySelectorAll("*[template-reload]");for(let t=0,a=e.length;t<a;t++){var n=e[t],r=n.getAttribute("template-reload")??!1,p=n.getAttribute("template-string")??!1;if(!1!=p){!1!=r&&!1==p&&n.setAttribute("template-string",n.innerHTML);var o=TemplateEngineExtractLiterals(p);0!=o.length&&TemplateEngineAssignElement(n,o,p)}}return null}function SnapElement(e,t,a,n=500,r=[],p=[]){if((firstSetup=void 0===e.snapElementState)&&(e.snapElementState=!0),!firstSetup&&!0==e.snapElementState)return!1;e.snapElementState=!0;var o=t.getBoundingClientRect(),l=a.getBoundingClientRect(),m=getComputedStyle(e).position;getComputedStyle(e).transition,getComputedStyle(e).width,getComputedStyle(e).height;var s,u="anim_"+GenerateUUID().replace(/-/g,"_"),d=r.join(";"),c=`
[temporary-animation="${u}_trigger"]{animation:${u} ${n/1e3}s alternate forwards;}@keyframes ${u}{0%{top:${o.top}px;left:${o.left}px;width:${o.width}px;height:${o.height}px;${d}}100%{top:${l.top}px;left:${l.left}px;width:${l.width}px;height:${l.height}px;${p.join(";")}}}
`,f=document.createElement("style");f.id=u,f.innerHTML=c,app.element.cssTemporary.appendChild(f),e.style.position="fixed",e.setAttribute("temporary-animation",u+"_trigger"),setTimeout(function(){e.snapElementState=!1,e.removeAttribute("temporary-animation"),f.remove(),e.style.position=m},n)}function actionRenameItem(e=-1,t=null){if(-1==e)return -1;if(null==t||!(t instanceof HTMLElement))return -2;var a=app.items[e].uuid.toString(),n=app.items[e].title.toString();app.element.addItemOptions.querySelector("input[name=title]").value=n,app.element.addItemOptions.querySelector("input[name=uuid]").value=a,app.element.addItemOptions.initiatorElement=t,app.element.addItemOptions.setAttribute("data-action","rename-item");var r=app.element.addItemOptions.querySelectorAll("*"),p=r.length;for(let o=0;o<p;o++){var l=r[o];l.cssDefaultTransition=getComputedStyle(l).transition,l.style.opacity="0",l.style.transition="opacity .3s ease"}app.element.addItemOptions.setAttribute("data-hidden","0"),SnapElement(app.element.addItemOptions,t,app.element.addItemOptions,400,["border-radius: 16px","background: rgba(128, 128, 128, .2)"]),setTimeout(function(){for(let e=0;e<p;e++)r[e].style.opacity="1"},300),setTimeout(function(){for(let e=0;e<p;e++){var t=r[e];t.style.transition=t.cssDefaultTransition}},400),app.element.addItemOptions.querySelector("input[name=title]").focus()}function actionAddItem(){app.element.addItemOptions.setAttribute("data-action","add-item");var e=app.element.addItemOptions.querySelectorAll("*"),t=e.length;for(let a=0;a<t;a++){var n=e[a];n.cssDefaultTransition=getComputedStyle(n).transition,n.style.opacity="0",n.style.transition="opacity .3s ease"}app.element.addItemOptions.setAttribute("data-hidden","0"),SnapElement(app.element.addItemOptions,app.element.addItemButton,app.element.addItemOptions,400,["border-radius: 16px","background: rgba(128, 128, 128, .2)"]),setTimeout(function(){for(let a=0;a<t;a++)e[a].style.opacity="1"},300),setTimeout(function(){for(let a=0;a<t;a++){var n=e[a];n.style.transition=n.cssDefaultTransition}},400),app.element.addItemOptions.querySelector("input[name=title]").focus()}function appReloadTemplatesOnAction(){app.templates.NumberOfTodoItems=Number(app.storage.getItem("itemsSize")),0>app.templates.NumberOfTodoItems&&(app.templates.NumberOfTodoItems=0),app.templates.NumberOfTodoItems>1||0==app.templates.NumberOfTodoItems?app.templates.NumberOfTodoItemsNoun="s":app.templates.NumberOfTodoItemsNoun="",0==app.templates.NumberOfTodoItems?app.templates.NumberOfTodoItemsChar="...":app.templates.NumberOfTodoItemsChar="!",app.templates.NumberOfTodoItems=app.templates.NumberOfTodoItems.toLocaleString(),TemplateEngineAssignReload()}app.container=document.querySelector("app-container"),app.element=[],app.element.items=app.container.querySelector(".items-list"),app.element.cssTemporary=document.body.querySelector("css-temporary"),app.element.aboveItemsList=app.container.querySelector(".above-items-list"),app.element.addItemButton=app.element.aboveItemsList.querySelector(".add-item button"),app.element.addItemOptions=app.container.querySelector(".add-item-options"),app.element.infoModalChooser=app.container.querySelector(".info-modal-chooser"),app.items=[],app.storage=window.localStorage,app.items=JSON.parse(app.storage.getItem("items")),(null==app.items||""==app.items)&&(app.items=[],app.storage.setItem("items","[]"),app.storage.setItem("itemsSize",0)),app.templates=[],app.templates.Username="OhMyProgramming",app.templates.AppName="To-do App",app.templates.AppNamePackage="com.todo.app",app.templates.NumberOfTodoItems=Number(app.storage.getItem("itemsSize")),app.templates.NumberOfTodoItemsNoun="",app.templates.NumberOfTodoItemsChar="!",(app.templates.NumberOfTodoItems>1||0==app.templates.NumberOfTodoItems)&&(app.templates.NumberOfTodoItemsNoun="s"),0==app.templates.NumberOfTodoItems&&(app.templates.NumberOfTodoItemsChar="..."),app.templates.NumberOfTodoItems=app.templates.NumberOfTodoItems.toLocaleString(),TemplateEngineAssign(),LoadListItems(),app.element.addItemOptions.querySelector("button.action-discard").addEventListener("click",function(e){e.preventDefault();var t=this.parentElement.parentElement,a=t.getAttribute("data-action");if("null"!=a){if("add-item"==a||"rename-item"==a){t.setAttribute("data-action","null"),t.querySelector("input[name=title]").value="",t.querySelector("input[name=uuid]").value="",function e(){var a=t.querySelectorAll("*"),n=a.length;for(let r=0;r<n;r++)a[r].style.opacity="0"}();var n=app.element.addItemButton;"rename-item"==a&&(n=app.element.addItemOptions.initiatorElement),SnapElement(app.element.addItemOptions,app.element.addItemOptions,n,400,[],["border-radius: 16px","opacity: 0"]),setTimeout(function(){t.setAttribute("data-hidden","1")},400)}t.querySelector("p.heading").innerText="Add items2!"}}),app.element.addItemOptions.querySelector("button.action-accept").addEventListener("click",function(e){e.preventDefault();var t=this.parentElement.parentElement,a=t.getAttribute("data-action"),n=t.querySelector("input[name=title]"),r=t.querySelector("input[name=uuid]").value??!1;function p(){var e=t.querySelectorAll("*"),a=e.length;for(let n=0;n<a;n++)e[n].style.opacity="0"}if("null"!=a){if("add-item"==a){if(0==n.value.trim().length)return;AddItem({title:n.value}),appReloadTemplatesOnAction(),t.setAttribute("data-action","null"),t.querySelector("input[name=title]").value="",p(),SnapElement(app.element.addItemOptions,app.element.addItemOptions,app.element.addItemButton,400,[],["border-radius: 16px","opacity: 0"]),setTimeout(function(){t.setAttribute("data-hidden","1")},300)}if("rename-item"==a){if(0==n.value.trim().length||!1==r)return;var o=GetItem(r,!0);app.items[o].title=n.value.trim(),app.storage.setItem("items",JSON.stringify(app.items)),app.element.items.innerHTML="",LoadListItems(),t.setAttribute("data-action","null"),t.querySelector("input[name=title]").value="",p(),SnapElement(app.element.addItemOptions,app.element.addItemOptions,app.element.addItemButton,400,[],["border-radius: 16px","opacity: 0"]),setTimeout(function(){t.setAttribute("data-hidden","1")},300)}}}),document.body.addEventListener("click",function(e){e.preventDefault();var t=e.target;if(t instanceof HTMLButtonElement){var a=t.parentElement.parentElement,n=a.parentElement.getAttribute("class")??!1,r=a.getAttribute("class")??!1,p=a.getAttribute("data-uuid")??!1;if("add-item"==t.parentElement.getAttribute("class")&&null!==(runFunction=t.getAttribute("run-function"))&&"addItem"==runFunction){actionAddItem();return}if(!1==n)return;if(n.includes("items-list")){if(!1==r)return;if(r.includes("item")){if(!1==p)return;var o,l=t.getAttribute("class");if("object"==typeof(l=l.includes(" ")?l.split(" "):l.substr(5)))for(let m=0,s=l.length;m<s;m++){var u=l[m].toString().toLowerCase();if("icon-"===u.toLowerCase().substr(0,5)){l=u.substr(5);return}}if("rename"===l){0>actionRenameItem(GetItem(p,!0),t)&&alert("An error occured during actionRenameItem().");return}if("accept"===l){if(r.includes("accepted")){a.className=r.replace("accepted","").trim(),AcceptItem(p);return}a.className+=" accepted",AcceptItem(p)}"remove"===l&&(RemoveItem(p),a.remove(),appReloadTemplatesOnAction())}}}});